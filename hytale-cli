#!/bin/sh
CONTAINER="hytale_server"
PIPE="/data/console.pipe"

if [ -z "$(docker ps -q -f name=$CONTAINER)" ]; then echo "Error: Server not running."; exit 1; fi

docker logs -f -n 0 "$CONTAINER" &
LOG_PID=$!
trap 'kill $LOG_PID 2>/dev/null; exit 0' EXIT SIGINT

while read -e cmd; do
    if [ -z "$cmd" ]; then continue; fi
    docker exec -u hytale "$CONTAINER" sh -c "echo \"$cmd\" > $PIPE"
done
